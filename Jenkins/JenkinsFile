properties([ 
	parameters([
	separator(name:"Refresh the Jenkins File",sectionHeader: "Jnekins File"),
	booleanParam(name: 'Refresh', defaultValue: false, description: 'Read Jenkinsfile and exit.'),
	string(name: 'Jenkins',description:'Keep this checked if you want to run this project Jenkins file' ),
	separator(name:"Refresh the Jenkins File",sectionHeader: "Enter the feature you want to Test"),
	booleanParam(name:'Login',defaultValue:false, description:'select login feature to run'),
	booleanParam(name:'Application',defaultValue:false, description:'select Application feature to run'),
	booleanParam(name:'TearDown',defaultValue:false, description:'select TearDown feature to run'),
	booleanParam(name:'AddTemplate',defaultValue:false, description:'select AddTemplate feature to run'),
	separator(name:"Refresh the Jenkins File",sectionHeader: "Select the Web to run the tests"),
	booleanParam(name:'Chrome',defaultValue:false, description:'select Chrome to run'),
	booleanParam(name:'Firefox',defaultValue:false, description:'select Firefox to run'),
	booleanParam(name:'Edge',defaultValue:false, description:'select Edge to run'),
	booleanParam(name:'Safari',defaultValue:false, description:'select Safari to run'),
	])
 ])
 def web =[ 
 Chrome:params.Chrome,
 Firefox:params.Firefox,
 Edge:params.Edge,
 Safari:params.Safari
  ]
  
 def Fee=[ 
 Login: params.Login,
 Application: params.Application,
 TearDown: params.TearDown,
 AddTemplate : params.AddTemplate
  ]
  
  def Groups = []

pipeline{ 

    agent any    
        stages{ 
          stage('Read Jenkinsfile') {
            when {
                expression {
                    return params.Refresh == true
                }
            }
            steps {
                echo "Jenkinsfile reloaded successfully and Exiting early"
            }
        }          
            stage('FrameworkSample'){                  
                    steps{
                  		  script{
                          if(params.Login){
                        echo 'Run the login method'
                    }
                    else {
                        echo 'Run the Application method'
                    }   
                    }   
                      echo 'Hello world'
                        echo "Hello ${params.Jenkins}" 
                        echo "You have selected ${params.Feature}"
                    }
                }
                stage('Execute the Feature'){
						steps{
						    script{
						    web.each{
						    if(it.value){
						       stage(it.key)
						       echo "${entity1.key}"
						       Fee.each{
						       if(it.value){
						           stage(it.key)
						           echo "${entity.key}"
						                echo "${entity.value}"
						                echo "${entity1.key}"
						        Groups << "${entity.key}"
						       }
						       catchError{
						                        echo 'might fail'
						                }
						      }
						    }
						} 
                }
                }
                }
                stage('Read the Group List'){
                                    steps{
                                        script{
                                            Groups.each{
                                                echo println it
                                            }

                                        }

                                    }

                                }

                
            }            
        }
        post{
            always{
           
                echo 'Say Hello again'
            }
        }

